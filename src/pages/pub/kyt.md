---
layout: '#layout/Publication.astro'
---
# KYT бот
## [Лимиты телеграмма](https://core.telegram.org/bots/faq#:~:text=For%20bulk%20notifications,broadcasts%20to%20increase%20the%20limit.)
Бесплатно 30 сообщений в секунду

Чтобы слать больше, нужно включить для бота разрешение слать больше:
- &lt; 100 000 активных пользователей бота
- &lt; 100 000 телеграм-звезд на счету (по их премиум боту, это 175 999₽)
- За каждое сообщение > 30 в секунду нужно платить 0.1 звезды, так, отправляя сообщения несколько раз в день такими
	пачками, мы будем высаживать эти 100 000 звезд за неделю.

100 000 сообщений это тот уровень, на котором мы еле уложимся с отправкой всех необходимых сообщений за час.

## Архитектура решения

1. Хранение конфигов, например для ботов, в амазоновском сторе
2. Авторизация
  Просто можно генерить ссылки на бота с id.
	вебхук будет связывать телеграм-id с пользователем

## План работы
Работать по 2-3 часа в день.
Синхронизировать прогресс 2 раза в неделю, вт и пт.
Глобальные чекпоинты можно делать раз в 2 недели. 

Этапы с 1 по 6 — подготовительные, проверить что все технологии работают в связке, потом с этим результатом разработать
детали: структуры данных, компоненты и связи в подробностях. После этого имплементация делается без особых проблем.

1. Развернуть текущее тестовое окружение (2-3 дня)
2. Собрать CDK в монорепозиторий (чтобы зафиксировать зависимости между шагами) (3-4 дня)
3. Развернуть тестовое окружение из монорепа (1-2 дня)
4. Зарегать тг-бота (1-2 дня)
5. Написать step-функцию, отправляющую сообщение по таймеру (2-3 дня)
6. Написать	лямбду-вебхук, считывающий ответ с кнопки (1-2 дня)
7. Проработать стейт-машину: Нарисовать схему (7 дней)
	1. Авторизация
	2. Переотправка сообщений
	3. Отображение статуса ответов
	4. Связь с текущей бд и аналитикой
8. Реализовать стейт-машину (14 дней)
9. Развернуть стейджинг (2-3 дня)
10. Тестирование (7 дней)
11. Развернуть прод (2 дня)

### Оценка
Оптимистично: 42 дня.
Пессимистично: 49 дней.
